<!DOCTYPE html>
<html lang="en">
<head>
	<title>Fake News Checker</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='jquery-circle-progress/dist/circle-progress.js') }}"></script>
	<script type="text/javascript" src="{{ url_for('static', filename='chart-js/Chart.min.js') }}"></script>
	<script type="text/javascript" src="{{ url_for('static', filename='twitter-widgets/widgets.js') }}"></script>
</head>

<body>

	<nav class="navbar navbar-expand-sm bg-dark navbar-dark justify-content-between">
	<div class="container">
		<a class="navbar-brand" href={{ url_for('index') }}>Fake News Checker</a>
		<form action="/" method="POST" class="form-inline">
			<div class="input-group">
				<div class="input-group-prepend">
					<span class="input-group-text">#</span>
				</div>
				<input name="data" type="text" class="form-control" placeholder="Search again">
				<div class="input-group-append">
					<button class="btn btn-success" type="submit">Search</button>
				</div>
			</div>
		</form>
	</div>
	</nav>

	<div class="container">
		<br>
		<br>
		<div class="jumbotron bg-dark">
		<div class="row justify-content-between">
			<div class="col-sm-7">
				 <font color="white">
				<b><h1 style="color: #28A745"> {{data['credScore']}}% </h1></b>
				<br>
				<h3> The overall truth rating of <b> {{data['nTweets']}} </b> tweets relating to <b>{{search_string}}</b> </h3>
				<br>
				</font>
			</div>
			<div id="circle" class="col-sm-3">
			</div>
			<script>
				$('#circle').circleProgress({
				value: {{data['credScore']/100}},
				startAngle: -1.57,
				size: 175,
				fill: '#28A745',
				thickness: 40,
				});
			</script>
		</div>
		</div>

		<br>
		<h3>Core Metrics:</h3>
		<hr>
		<div class="row">

		<div class="col">
			<div class="card bg-light" style="width:250px">
				<div class="card-body">
					<h4 class="card-title">{{data['aveRetweetCount']}}</h4>
					<p class="card-text">Average Retweet Count</p>
				</div>
			</div>
		</div>

		<br>

		<div class="col">
			<div class="card bg-light" style="width:250px">
				<div class="card-body">
					<h4 class="card-title">{{data['aveFriendCount']}}</h4>
					<p class="card-text">Average Follower Count</p>
				</div>
			</div>
		</div>

		<br>

		<div class="col">
			<div class="card bg-light" style="width:250px">
				<div class="card-body">
					<h4 class="card-title">{{data['avReplyCount']}}</h4>
					<p class="card-text">Average Reply Count</p>
				</div>
			</div>
		</div>

		<br>

		<div class="col">
			<div class="card bg-light" style="width:250px">
				<div class="card-body">
					<h4 class="card-title">{{data['aveHashtagsInTweets']}}</h4>
					<p class="card-text">Average Hashtag Count</p>
				</div>
			</div>
		</div>

		<br>

		</div>

		<br>
		<br>
		<br>
		<h3>Important Tweets Relating to Your Story</h3>
		<hr>
		<div class="row justify-content-center">
			<div class="col-4"><div class="tweet" id="{{data['tweetsByVerified'][0]}}"></div></div>
			<div class="col-4"><div class="tweet" id="{{data['tweetsByVerified'][1]}}"></div></div>
			<div class="col-4"><div class="tweet" id="{{data['tweetsByVerified'][2]}}"></div></div>
		</div>

		<br>
		<br>
		<br>
		<h3>Semantic Analysis:</h3>
		<hr>
		<div class="row justify-content-center">
			<br>
			<div class="col-4">
				<canvas id="piechart" width="300" height="300"></canvas>
				<script>
				var pieData = [
				{% for item,label,colors in set %}
				{
				value: {{item}},
				label: "{{label}}",
				color : "{{colors}}"
				},
				{% endfor %}
				];
				// get bar chart canvas
				var mychart = document.getElementById("piechart").getContext("2d");
				steps = 10
				max = 10
				// draw pie chart
				new Chart(document.getElementById("piechart").getContext("2d")).Doughnut(pieData);
	 		</script>
		</div>
		<div class="col-4">
			<br>
			<h5> Most positive related tweet: </h5>
			<div class="tweet" id="{{data['strongPosTweets'][0]}}"></div>
		</div>
		<div class="col-4">
			<br>
			<h5> Most negative related tweet: </h5>
			<div class="tweet" id="{{data['strongNegTweets'][0]}}"></div>
		</div>
		</div>

		<br>
		<br>
		<br>
		<h3>How the story broke:</h3>
		<hr>
		<div class="row justify-content-center">
			<canvas id="chart" width="800" height="400"></canvas>
			<script>
				var barData = {
					labels : [{% for item in time_chart_data[0] %}
				                  "{{item}}",
				              {% endfor %}],
				   datasets : [
				      {
				            fillColor: "rgba(151,187,205,0.2)",
				            strokeColor: "rgba(151,187,205,1)",
				            pointColor: "rgba(151,187,205,1)",
				            pointStrokeColor: "#fff",
				            pointHighlightFill: "#fff",
				            pointHighlightStroke: "rgba(151,187,205,1)",
				            bezierCurve : true,
				            data : [{% for item in time_chart_data[1] %}
				                      {{item}},
				                    {% endfor %}]
				      }]
				   }

				    Chart.defaults.global.animationSteps = 50;
				    Chart.defaults.global.tooltipYPadding = 16;
				    Chart.defaults.global.tooltipCornerRadius = 0;
				    Chart.defaults.global.tooltipTitleFontStyle = "normal";
				    Chart.defaults.global.tooltipFillColor = "rgba(0,0,0,0.8)";
				    Chart.defaults.global.animationEasing = "easeOutBounce";
				    Chart.defaults.global.scaleLineColor = "black";
						Chart.defaults.global.responsive = true;
				    Chart.defaults.global.scaleFontSize = 16;

				   // get bar chart canvas
				   var mychart = document.getElementById("chart").getContext("2d");

				   // draw bar chart
				   var LineChartDemo = new Chart(mychart).Line(barData, {
				        scaleShowVerticalLines: true,
				        scaleShowGridLines : true,
				        barShowStroke : true,
				        scaleShowLabels: true,
				        bezierCurve: true,
				   });
				</script>
		</div>

	</div>

	<script>
	var tweets = jQuery(".tweet");

	jQuery(tweets).each( function( t, tweet ) {

	var id = jQuery(this).attr('id');

	twttr.widgets.createTweet(
		id, tweet,
		{
			conversation : 'none',    // or all
			cards        : 'hidden',  // or visible
			linkColor    : '#cc0000', // default is blue
			theme        : 'light'    // or dark
		});

	});
	</script>

</body>

</html>
